---
name: Default
version: 1.0.0
schema: v1

models:
  - uses: ollama/granite4-micro
    override:
      name: Granite 4 Micro
      model: hf.co/mradermacher/Huihui-granite-4.0-micro-abliterated-GGUF:Q6_K

  - name: Qwen 3 Embedding 0.6B
    provider: ollama
    model: hf.co/Qwen/Qwen3-Embedding-0.6B-GGUF:Q8_0
    roles:
      - embed

  - name: Qwen 3 Reranker 0.6B
    provider: ollama
    model: hf.co/mradermacher/Qwen3-Reranker-0.6B-GGUF:Q8_0
    roles:
      - rerank

  - uses: mistral/codestral
    with:
      MISTRAL_API_KEY: ${{ secrets.CODESTRAL_API_KEY }}
    override:
      model: codestral-2508
      defaultCompletionOptions:
        contextLength: 256000

  - uses: mistral/mistral-large
    with:
      MISTRAL_API_KEY: ${{ secrets.MISTRAL_API_KEY }}
    override:
      model: mistral-large-2411
      defaultCompletionOptions:
        contextLength: 131072

  - uses: mistral/devstral-medium
    with:
      MISTRAL_API_KEY: ${{ secrets.MISTRAL_API_KEY }}
    override:
      model: devstral-medium-2507
      defaultCompletionOptions:
        contextLength: 131072

  - uses: openai/gpt-4.1
    with:
      # Use API key from GitHub Copilot
      # Refer to https://aider.chat/docs/llms/github.html
      OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
    override:
      name: GPT 4.1 (via GitHub Copilot)
      apiBase: https://api.githubcopilot.com
      model: gpt-4.1

mcpServers:
  - uses: upstash/context7-mcp

  - name: Sequential Thinking
    command: pnpm
    args:
      - "dlx"
      - "@modelcontextprotocol/server-sequential-thinking@2025.7.1"

  - name: GitHub
    command: podman
    type: stdio
    args:
      - "run"
      - "-i"
      - "--rm"
      - "-e"
      - "GITHUB_PERSONAL_ACCESS_TOKEN"
      - "-e"
      - "GITHUB_TOOLSETS"
      - "ghcr.io/github/github-mcp-server:v0.22.0"
    env:
      GITHUB_PERSONAL_ACCESS_TOKEN: ${{ secrets.GITHUB_PERSONAL_ACCESS_TOKEN }}
      GITHUB_TOOLSETS: default,code_security,secret_protection,security_advisories

  - name: Google Cloud
    command: pnpm
    args:
      - "dlx"
      - "@google-cloud/gcloud-mcp@0.4.0"

  - name: Time
    command: uvx
    args:
      - "mcp-server-time==2025.9.25"

  - name: Git
    command: uvx
    args:
      - "mcp-server-git==2025.9.25"

  - name: GitLab CSUI
    command: pnpm
    args:
      - "dlx"
      - "@zereight/mcp-gitlab@2.0.8"
    env:
      GITLAB_PERSONAL_ACCESS_TOKEN: ${{ secrets.GITLAB_CSUI_PERSONAL_ACCESS_TOKEN }}
      GITLAB_API_URL: ${{ secrets.GITLAB_CSUI_API_URL }}
      GITLAB_DENIED_TOOLS_REGEX: "(label|labels|release|releases|release_evidence|release_asset|namespace|namespaces)$"
      USE_GITLAB_WIKI: "false"
      USE_PIPELINE: "false"
      USE_MILESTONE: "false"

context:
  - provider: file
  - provider: code
  - provider: diff
  - provider: tree
    params:
      nRetrieve: 25
      nFinal: 5
      useReranking: true
  - provider: docs
    params:
      nRetrieve: 25
      nFinal: 5
      useReranking: true
